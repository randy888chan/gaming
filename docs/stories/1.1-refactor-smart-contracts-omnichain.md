### **Story 1.1: Refactor Smart Contracts for Omnichain Support**

- **As:** The System Architect
- **I want:** The `CrossChainSettlement.sol` and `PolymarketAdapter.sol` contracts to be updated
- **So that:** They correctly handle message formats and addresses for **EVM, Solana, and TON** as relayed by ZetaChain

**Acceptance Criteria (ACs):**

1. `CrossChainSettlement.sol`'s dispatch function correctly handles `bytes` for the destination address to support non-EVM formats
2. `PolymarketAdapter.sol`'s `placeBet` simulation logic is removed and replaced with a production-ready implementation that correctly interfaces with the `onZetaMessage` flow
3. The inefficiency in `onZetaMessage` (multiple decodes) is resolved; the payload is decoded only once
4. New unit tests are added to `test/evm/` to verify omnichain call paths for Solana and TON addresses, ensuring they don't revert

**Technical Context:**

- `CrossChainSettlement.sol` (zEVM) is the universal dispatcher contract that handles all cross-chain operations
- `PolymarketAdapter.sol` (EVM) is the target contract that processes ZetaChain messages for Polymarket interactions
- Message flow: Frontend → zetaChainService → CrossChainSettlement.sol → ZetaChain Gateway → Target Chain Contract
- Destination addresses must be in `bytes` format to support non-EVM chains like Solana and TON
- The current `onZetaMessage` function inefficiently decodes payload multiple times

**Implementation Tasks:**

1. Update `CrossChainSettlement.sol` dispatch function to accept `bytes` for destination address
2. Refactor `PolymarketAdapter.sol`:
   - Remove simulation logic from `placeBet`
   - Implement production-ready integration with `onZetaMessage`
   - Optimize payload decoding to single operation
3. Add unit tests for Solana and TON address handling:
   - Test successful message dispatch to non-EVM addresses
   - Test failure cases and error handling
4. Verify all changes work with ZetaChain's cross-chain protocol

**Relevant Files:**

- `contracts/evm/CrossChainSettlement.sol`
- `contracts/evm/PolymarketAdapter.sol`
- `test/evm/CrossChain.test.ts`
- `docs/architecture/architecture.md` (for reference)
